%!TEX root = ../main.tex

\definecolor{fcdGrayA}{HTML}{111111}
\definecolor{fcdGrayB}{HTML}{222222}
\definecolor{fcdGrayC}{HTML}{333333}
\definecolor{fcdGrayD}{HTML}{444444}
\definecolor{fcdGrayE}{HTML}{555555}
\definecolor{fcdGrayF}{HTML}{666666}
\definecolor{fcdGrayG}{HTML}{777777}
\definecolor{fcdGrayH}{HTML}{888888}
\definecolor{fcdGrayI}{HTML}{999999}
\definecolor{fcdGrayJ}{HTML}{AAAAAA}
\definecolor{fcdGrayK}{HTML}{BBBBBB}
\definecolor{fcdGrayL}{HTML}{CCCCCC}
\definecolor{fcdGrayM}{HTML}{DDDDDD}
\definecolor{fcdGrayN}{HTML}{EEEEEE}

\colorlet{ClrSFit}{blue}
\colorlet{ClrSFitBT}{blue}
\colorlet{ClrNominalFit}{red}

\begin{tikzpicture}[
  exp_label/.style={
    anchor=west,
    %minimum width=10em,
    align=left,
    font=\small\sffamily,
    inner sep=0.5em,
    outer sep=0,
  },
  exp_result/.style={
    anchor=east,
    align=right,
    font=\footnotesize\sffamily,
    inner sep=0.5em,
    outer sep=0,
    yshift=0.22em
  }
]
\begin{axis}[
  width=\textwidth,
  height=30ex,
  font=\small,
  xmin=0.62,xmax=0.80,ymin=0.3,ymax=3.7,
  xlabel={${\SJpsiKS}$},
  xlabel style={
        at={(ticklabel cs:1)},
        anchor=north east,
    },%
  xtick={0.67, 0.69, 0.71, 0.73, 0.75, 0.77},
  xticklabel style={%
    major tick length=3pt,
    /pgf/number format/fixed
  },
  hide y axis
]

\begin{pgfonlayer}{background}
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.67,0}) -- ({rel axis cs:0.67,1}-|{axis cs:0.67,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.68,0}) -- ({rel axis cs:0.68,1}-|{axis cs:0.68,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.69,0}) -- ({rel axis cs:0.69,1}-|{axis cs:0.69,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.70,0}) -- ({rel axis cs:0.70,1}-|{axis cs:0.70,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.71,0}) -- ({rel axis cs:0.71,1}-|{axis cs:0.71,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.72,0}) -- ({rel axis cs:0.72,1}-|{axis cs:0.72,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.73,0}) -- ({rel axis cs:0.73,1}-|{axis cs:0.73,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.74,0}) -- ({rel axis cs:0.74,1}-|{axis cs:0.74,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.75,0}) -- ({rel axis cs:0.75,1}-|{axis cs:0.75,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.76,0}) -- ({rel axis cs:0.76,1}-|{axis cs:0.76,0});
  \draw[ultra thin,color=fcdGrayM,dashed]({rel axis cs:0,0}-|{axis cs:0.77,0}) -- ({rel axis cs:0.77,1}-|{axis cs:0.77,0});

  % 2 sigma error band
  \fill[color=fcdGrayM] ({rel axis cs:0,0}-|{axis cs:0.72510503111,0}) rectangle ({rel axis cs:0.71465031339,1}-|{axis cs:0.71465031339,0});
  % 1 sigma error band
  \fill[color=fcdGrayK] ({rel axis cs:0,0}-|{axis cs:0.72249135168,0}) rectangle ({rel axis cs:0.71726399282,1}-|{axis cs:0.71726399282,0});
  % average
  \draw[ultra thin,color=fcdGrayI]({rel axis cs:0,0}-|{axis cs:0.71987767225,0}) -- ({rel axis cs:0.71987767225,1}-|{axis cs:0.71987767225,0});
\end{pgfonlayer}

\node[exp_label, color=ClrSFit] (SFit_lbl) at (axis cs: \pgfkeysvalueof{/pgfplots/xmin},3)  
{\sPlot fit\\[-0.3ex]\footnotesize \Hesse};
\node[exp_result,color=ClrSFit] (SFit_rsl) at (axis cs: \pgfkeysvalueof{/pgfplots/xmax},3) 
{${0.710 \pm 0.027}$};

\addplot+[only marks,
    thin,
    solid,
    color = ClrSFit,
    mark=none,
    mark options={%
      scale=0.7,
      draw=ClrSFit
    },
    error bars/.cd,
    x dir=both, x explicit,
    y dir=both, y explicit,
    error mark options={%
      rotate=90,
      mark size=5pt,
      color=ClrSFit
    }
]
table[
        x error plus=ex+,
        x error minus=ex-,
]{
  x            y  ex+            ex-  
  0.7103944525 3  0.02727126003  0.02727126003
};

\node[exp_label, color=ClrSFitBT] (SFit_lbl) at (axis cs: \pgfkeysvalueof{/pgfplots/xmin},2)  
{\sPlot\\[-0.3ex]\footnotesize bootstrapped fits};
\node[exp_result,color=ClrSFitBT] (SFit_rsl) at (axis cs: \pgfkeysvalueof{/pgfplots/xmax},2) 
{${0.711 \pm\,^{0.035}_{0.036}}$};

\addplot+[only marks,
    thin,
    solid,
    color = ClrSFitBT,
    mark=none,
    mark options={%
      scale=0.7,
      draw=ClrSFitBT
    },
    error bars/.cd,
    x dir=both, x explicit,
    y dir=both, y explicit,
    error mark options={%
      rotate=90,
      mark size=5pt,
      color=ClrSFitBT
    }
]
table[
        x error plus=ex+,
        x error minus=ex-,
]{
  x            y  ex+           ex-  
  0.7112513174 2  0.03487712232 0.03601769196
};

\node[exp_label, color=ClrNominalFit] (NominalFit_lbl) at (axis cs: \pgfkeysvalueof{/pgfplots/xmin},1)  
{Nominal fit};
\node[exp_result,color=ClrNominalFit] (NominalFit_rsl) at (axis cs: \pgfkeysvalueof{/pgfplots/xmax},1) 
{${0.729 \pm 0.035}$};

\addplot+[only marks,
    thin,
    solid,
    color = ClrNominalFit,
    mark=none,
    mark options={%
      scale=0.7,
      draw=ClrNominalFit
    },
    error bars/.cd,
    x dir=both, x explicit,
    y dir=both, y explicit,
    error mark options={%
      rotate=90,
      mark size=5pt,
      color=ClrNominalFit
    }
]
table[
        x error plus=ex+,
        x error minus=ex-,
]{
  x            y  ex+             ex-  
  0.7285040271 1 0.03461272157    0.03477905032
};

\end{axis}
\end{tikzpicture}
