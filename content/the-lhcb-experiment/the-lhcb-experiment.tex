%!TEX root = ../../common/main.tex

\chapter{The \acs*{LHCb} experiment}
\label{ch:lhcb_experiment}
General overview of the detector: physics case, (collaboration,) design, advantages over ATLAS, CMS, ALICE; 

physics motivation:
heavy flavour physics, indirect searches/evidence, BSM, CP violation, rare decays, beauty and charm hadrons, fully consistent with the SM and CKM, matter-antimatter asymmetry, new source of CPV beyond the SM needed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The \acs*{LHC} and its experiments}
\label{sec:lhcb_experiment:lhc}

With a circumference of \SI{26.7}{\kilo\metre} the \LHC is the largest man-made
particle accelerator. Using a \enquote{two-in-one} super-conducting magnet
design, two counter-rotating beams of protons (or ions) are intersected and
brought to collision at four interaction points, home of the large \LHC
experiments \acs*{ALICE}, \acs*{ATLAS}, \acs*{CMS}, and \acs*{LHCb}. The
colliders centre-of-mass energy of $\sqrt{s}=\SI{14}{\TeV}$ and a peak
luminosity of $L=\SI{e34}{\lumi}$ provide \LHC's experiments with high event
rates that are necessary in their searches for physics beyond the \SM.

Following approval in 1994, the \LHC re-used the existing \LEP tunnel and most
of its infrastructure after \LEP shut down in 2000. The \LHC---and former
\LEP---tunnel is built up of eight straight and eight arc sections and has a
internal diameter of $\SI{3.7}{\metre}$. It is located north-west of Geneva,
Switzerland at a depth between $\SI{45}{\metre}$ and $\SI{170}{\metre}$ below
the surface. The storage ring consists of superconducting NbTi magnets kept at
an operating temperature of $\SI{1.9}{\kelvin}$ by superfluid helium. A
superconducting \RF cavity system captures, accelerates, and stores the two
proton beams.

At design luminosity, $\num{2808}$ bunches with a bunch spacing of
$\SI{25}{\nano\metre}$ are stored in each proton beam. The \LHC relies on a
supply chain of smaller accelerators providing the initial proton bunches.
\Cref{fig:lhcb_experiment:lhc:cern_accelerator_complex} depicts the \acs{CERN}
accelerator complex. A bottle of hydrogen gas is the source of the protons, that
are then subsequently accelerated to higher energies by the \LINACTwo, the
\BOOSTER, the \PSyn, and the \SPS, before being injected into the \LHC at an
energy of $\SI{450}{\GeV}$. The transfer lines Tl2 and Tl8 are used to inject
the protons bunches in both beam directions. As soon as the nominal number of
proton bunches is reached, the beam energies are increased up to $\SI{7}{\TeV}$
for each beam. The average \LHC turnaround time, \ie the time it takes to run
through the whole accelerator chain until a stable beam is achieved, adds up to
seven hours. Mainly due to beam loss from \pp collisions the beam intensities
and the instantaneous luminosity decays. Starting from a peak luminosity of
$L=\SI{e34}{\lumi}$ a luminosity lifetime of 15 hours is estimated. To prevent
uncontrolled beam losses and to protect the \LHC infrastructure and the \LHC
experiments a beam dump system is installed. The fully automated system monitors
the beam condition and is able to extract the beam from the \LHC using kicker
magnets in case of a failure. The beam dump system is also used regularly to
extract the beam after a successful run. For more information on the \LHC and
resident experiments, see \eg \Ref~\cite{Evans:2008zzb}.

\begin{figure}[t]
  %% trim={<left> <lower> <right> <upper>}
  \includegraphics[width=\textwidth, trim={4.8cm 5.3cm 4.2cm 1.8cm}, clip=true]{private/content/the-lhcb-experiment/figs/cern_acceleator_complex.pdf}
  \caption{
  The \acs{CERN} accelerator complex \cite{Christiane:1260465}. Starting from
  the \acs{LINACTwo}, protons are accelerated through the \acs{BOOSTER}, the
  \acs{PSyn} and finally the \acs{SPS} before being injected into the \LHC. If
  one or both beams consist of heavy ions, the \acs*{LINACThree} and the
  \acs*{LEIR} are used to accelerate the ions and inject them into the
  \acs{PSyn}. }
  \label{fig:lhcb_experiment:lhc:cern_accelerator_complex}
\end{figure}

Shortly after the first successful circulation of two proton beams in September
2008, a fault occurred in the electrical bus connection between two magnets,
leading to a large helium leak and serious damage to several of \LHC's magnets
and infrastructure. After the incident, the management decided to reduce the
beam energy and intensity. Thus, in the years 2010 and 2011 the \LHC
centre-of-mass energy was $\sqrt{s}=\SI{7}{\TeV}$ with a bunch spacing of
$\SI{50}{\nano\metre}$ delivering a peak instantaneous luminosity of
$\SI{2.4e33}{\lumi}$. An increase of the beam energy to $\sqrt{s}=\SI{8}{\TeV}$
lead to a peak instantaneous luminosity of $\SI{7.7e33}{\lumi}$ in 2012
\cite{Lamont:2013cma}.

The \LHC is not only capable of colliding protons but also lead ions in Pb-Pb
as well as in \proton-Pb and Pb-\proton collisions. For this purpose the \ALICE
detector \cite{Aamodt:2008zz} is specifically designed to study QCD interactions
and the quark-gluon plasma produced in the \LHC ion runs, where it has to cope
with very large particle multiplicities. In the case of an heavy ion run, the
\LINACThree and the \LEIR mark the starting point of the accelerator chain,
before injecting the lead ions into the \PSyn.

In total, seven experiments are located at the four interaction regions of the
\LHC. The two multi-purpose detectors \ATLAS \cite{Aad:2008zzm} and \CMS
\cite{Chatrchyan:2008aa} are installed at opposite sides of the storage ring.
Both experiments cover a great variety of physics activities: the search for
scalar particles, particles predicted by super-symmetric models, dark matter
candidates, and evidence for extra spacial dimensions. Around the interaction
regions of the \CMS experiment, the \TOTEM detectors \cite{Anelli:2008zza} are
located. Together with the \LHCf experiment \cite{Adriani:2008zz}, located on
both sides of the \ATLAS interaction region, the detectors are designated to
address the study of the \enquote{forward} region of the collisions at very
small angles to the beam direction. The seventh experiment \MoEDAL extends the
\LHC physics program to the direct search for magnetic monopoles. Still missing
in this list, is the \LHCb experiment, that will be explained in more detail in
the next section.

% to enforce definition of abbreviations
\acuse{LINACThree,LEIR,ALICE,ATLAS,CMS,TOTEM,MoEDAL,LHCf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{The LHCb detector}
\label{sec:lhcb_experiment:detector}

The \LHCb detector is a unique precision instrument solely designed to study \CP
violation and rare decays of beauty and charm hadrons. He is constructed as a
single-arm spectrometer covering an angular range from approximately
$\SI{10}{\mrad}$ to $\SI{300}{\mrad}$ ($\SI{250}{\mrad}$) in the
horizontal (vertical) plane.

The detector layout exploits the characteristics of the heavy flavour production
in \protonproton collisions at the \LHC. The production of heavy quarks in an
hadronic environment is dominated by gluon-gluon fusion and quark-antiquark
annihilation.

\info{Better understand how b quark production works at the LHC}
bbbar production process:
hadrons, PDF, gluon-gluon fusion

b hadron production: large number of b/c hadrons, bbbar crosssection, asymmetric
momentum distribution (plots!), hadronization into Bd, Bs, Bu, baryons;
production asymmetry

lumi leveling, angular acceptance, number of B decays in acceptance

\begin{figure}[t]
  \includegraphics[width=\textwidth]{private/content/the-lhcb-experiment/figs/lhcb_detector_overview.pdf}
  \caption{
    Schematic cross section of the \acs{LHCb} detector in the $(y,z)$ plane at
  $x=0$. The \protonproton interaction region is located at the coordinates
  $(0,0,0)$ on the left side of the figure. The beam pipe crosses the detector at
  $(0,0,z)$. The main interaction region is surrounded by the \acs*{VELO},
  following the \acs*{RICH}1 and the \acs*{TT}. On the right side of the magnet
  the three tracking stations (T1-3) consisting of the \acs*{IT} and the
  \acs*{OT} are installed. Further on, the \acs*{RICH}2, the calorimeter system
  (\acs*{SPD}, \acs*{PS}, \acs*{ECAL}, and \acs*{HCAL}), and the muon system
  (M1-5) is located. }
  \label{fig:lhcb_experiment:detector:overview}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Track reconstruction}
\label{sec:lhcb_experiment:tracking}

The \LHCb track reconstruction is based on information from a set of tracking
detectors: the \VELO, the \TT, the \IT and the \OT. Silicon microstrips are used
in the first three, while the latter is constructed as a drift-time detector.
The \VELO is described in \cref{sec:lhcb_experiment:tracking:velo}, the \TT and
the \IT in \cref{sec:lhcb_experiment:tracking:ttit}, and the \OT in
\cref{sec:lhcb_experiment:tracking:ot}.
\important{The magnet is missing!}

%%------------------------------------------------------------------------------
\subsection{The \acl*{VELO}}
\label{sec:lhcb_experiment:tracking:velo}

Surrounding the \protonproton interaction region the \VELO's main purpose is the
precise position measurement of traversing particles to reconstruct the \ac{PV}
and displaced \acp{SV}. To achieve the best possible spatial resolution the
sensors must be positioned close to the beam trajectory. To allow the sensors to
be as close as $\SI{8}{\milli\metre}$ to the interaction region and still
prevent damage during beam injection, the \VELO modules are split in two halves
an can be retracted until stable beams are present. Each single modules consists
of two half-disk shaped silicon microstrip sensor modules covering either the
radial dimensions ($R$ sensor) or the angular dimension ($\Phi$ sensor) as can
be seen in the schematic visualisation in
\cref{fig:lhcb_experiment:tracking:velo:sensor}.
%
\begin{figure}[t]
  \includegraphics[width=0.42\textwidth]{private/content/the-lhcb-experiment/figs/lhcb_detector_velo_sensors.pdf}
  \includegraphics[width=0.55\textwidth]{private/content/the-lhcb-experiment/figs/lhcb_detector_velo_assembly.jpg}
  \caption{(Left) Schematic representation of the $R$ and $\Phi$ sensor for one
  of the \VELO modules \cite{Alves:2008zz}. (Right) Picture of the \VELO during
  assembly \cite{Aaij:1707015}. }
  \label{fig:lhcb_experiment:tracking:velo:sensor}
\end{figure}
%
The \VELO covers the total \LHCb acceptance region, such that all tracks cross
at least three \VELO stations. \Cref{fig:lhcb_experiment:tracking:velo:overview}
shows the cross section of the \VELO in the $(x,z)$ plane at $y=0$ with all
modules visible. \info{VELO pile-up system?}
%
\begin{figure}[t]
  \includegraphics[width=\textwidth]{private/content/the-lhcb-experiment/figs/lhcb_detector_velo_overview.png}
  \caption{
    Cross section of the closed \VELO in the $(x,z)$ plane at $y=0$ \cite{Alves:2008zz}.
  }
  \label{fig:lhcb_experiment:tracking:velo:overview}
\end{figure}

% \begin{itemize}
%   \item purpose: displaced secondary vertices, decay length, decay time, IP
%   \item silicon modules in r and phi, geometrical dimensions, mechanical accuracy, closest approach to beam
%   \item acceptance: 1.6 < eta < 4.9; |z| < 10.6cm
%   \item requirement of at least three hits in the VELO stations
%   \item pile-up veto system
%   \item retractable, RF foil, in vacuum (primary and secondary)
%   \item hardware interlock system
%   \item performance(?)
% \end{itemize}
%%------------------------------------------------------------------------------
\subsection{TT \& IT}
\label{sec:lhcb_experiment:tracking:ttit}

The \TT as well as the \IT make use of silicon microstrip sensors to track
particle trajectories. The planar \TT station is located upstream of the magnet
and is $\SI{150}{\centi\metre}$ wide and $\SI{130}{\centi\metre}$ high. The
three \IT stations are on the downstream side of the magnet and cover a central
region around the beam pipe that is $\SI{120}{\centi\metre}$ wide and
$\SI{40}{\centi\metre}$ high. Each of the stations has four detector layers,
where the strips in the two inner layer are rotated $\pm\SI{5}{\degree}$ to
allow for two dimensional positioning.

%%------------------------------------------------------------------------------
\subsection{OT}
\label{sec:lhcb_experiment:tracking:ot}

The outer region of the three downstream tracking stations, called \OT, consists
of a drift-time detector constructed from an array of gas-filled straw-tube
modules. The large planar detector spans an active area of $\SI[product-units =
power]{6 x 5}{\metre}$. With drift times smaller than $\SI{50}{\nano\second}$
and a drift-coordinate resolution of $\SI{20}{\micro\metre}$ the \OT allows for
tracking in the low occupancy region around the \IT.

%%------------------------------------------------------------------------------
\subsection{Track reconstruction technique and performance}
\label{sec:lhcb_experiment:tracking:techniques_and_performance}
Results are form Bd2JpsiKS!
\begin{itemize}
  \item hits from VELO, TT, IT and OT are combined to form trajectories form the VELO to the calorimeters. 
  \item list different track types: long, upstream, downstream, VELO, T
  \item track seeds, Kalman filter, pattern recognition, ghosts
  \item definition of: reconstructible, successfully reconstructed
  \item performance numbers for long tracks and downstream tracks
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Particle identification}
\label{sec:lhcb_experiment:pid}

The \LHCb \PID system consists of two \acp{RICH}, up- and downstream of the
magnet, the calorimeter system, and the muon system. Based on the information
from the \PID systems a likelihood for a given particle hypothesis is
determined. The \acp{RICH} are further described in
\cref{sec:lhcb_experiment:pid:rich}, the calorimeter system in
\cref{sec:lhcb_experiment:pid:calo}, and the muon system in
\cref{sec:lhcb_experiment:pid:muon}.

%%------------------------------------------------------------------------------
\subsection{The \aclp*{RICH}}
\label{sec:lhcb_experiment:pid:rich}

Exploiting the radiation emitted by a charged particle moving through a medium
at a speed greater than the speed of light, the two \acp{RICH} are used to
distinguish between pions, kaons, and protons. As illustrated in
\cref{fig:lhcb_experiment:tracking:pid:radiator} the cherenkov angle
$\Theta_\mathrm{C}$ shows a strong momentum dependence and therefore different
radiators are used to get a particle hypothesis for low- and high-momentum
particles. The detectors make use of a system of flat and spherical mirrors to
reflect the emitted light to \acp{HPD}.

\RICH1 is located upstream of the magnet in between the \VELO and the \TT,
contains aerogel and \fluorocarbonfour gas radiators, and provides \PID for
particles with low momenta from $\SIrange[range-phrase = \text{ to },range-units
= single]{1}{60}{\GeVc}$. \RICH2 is located after the last tracking station,
uses \fluorocarbon gas as a radiator and allows \PID for particles in the range
from $\SIrange[range-phrase = \text{ to },range-units =
single]{15}{\geq100}{\GeVc}$.
%
\begin{figure}[t]
  \includegraphics[width=0.48\textwidth]{private/content/the-lhcb-experiment/figs/lhcb_detector_rich_momentum.pdf}
  \includegraphics[width=0.52\textwidth]{private/content/the-lhcb-experiment/figs/lhcb_detector_rich_radiator.png}
  \caption{Momentum dependence of the cherenkov angle $\Theta_\mathrm{C}$ for
  (left) all \RICH radiators \cite{Alves:2008zz} and (right) for the
  \fluorocarbonfour radiator only \cite{Adinolfi:2012qfa}.}
  \label{fig:lhcb_experiment:tracking:pid:radiator}
\end{figure}

%%------------------------------------------------------------------------------
\subsection{The calorimeter system}
\label{sec:lhcb_experiment:pid:calo}

The \LHCb calorimeter system is used for both trigger and \PID. It consists of
an \ECAL---including the \SPD and the \PS---followed by a \HCAL. All the
calorimeter sub-systems make use of the scintillation light originating from
traversing charged particles that is collected and transmitted by fibres to
\acp{PMT}.

First, the \SPD selects charged particles, secondly the \PS provides separation
of charged pions and electrons. Finally the \ECAL measures the energy deposition
and position of electromagnetic showers. The \HCAL is a massive
$\SI[product-units = power]{8.4 x 6.8}{\metre}$ planar, $\SI{500}{\tonne}$
detector, build-up from alternating iron plates and scintillating tiles,
providing energy measurements of hadronic showers.

%%------------------------------------------------------------------------------
\subsection{The muon system}
\label{sec:lhcb_experiment:pid:muon}

The muon system consists of five stations of \MWPC, provides muon \PID and
serves as a high \pT trigger. The system is located in front of (M1) and behind
(M2-M5) the calorimeter system. It is especially important for charmonium final
states, as $\BdToJpsiKS$ considered in the analysis described in this thesis.

%%------------------------------------------------------------------------------
\subsection{Particle identification technique and performance}
\begin{itemize}
  \item combine info from RICHs, calo, and muon system to identify: e,mu,pi,K,p also gamma, pi0
  \item hadron PID: likelihood approach, RICH pattern mached to all possible tracks under assumption of partice hypotheses. -> global pattern-recongnition
  \item RICH efficiency
  \item muon PID: extrapolating reconstructed tracks into the muon stations; considered a muon cand if a minimum number of stations have hits in their field of interest FOI
  \item muon PID efficiency
  \item lectron PID: balance of track momentum and energy of the charged cluster in the ECAL matched with extrapolated tracks; matching bremsstrahlung photons to electron tracks before the magnet
  \item gamma PID: ECAL cluster w/o associated track
  \item pi0 PID: 
  \item global performance: PV resolution of 10mum transverse to the beam and 60mum along the beam axis; invariant mass resolution between 12 and 25 MeV; lifetime resolution of around 40fs
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Trigger}
\label{sec:lhcb_experiment:trigger}

To cope with up to $\SI{40}{\mega\hertz}$ event rate and high particle
multiplicities an efficient online event selection (trigger) system is
necessary. The \LHCb trigger system consists of the hardware based \LZero
trigger and the \HLT software trigger. The \LZero uses custom made electronics
located in direct proximity of the readout electronics to provide a fast trigger
decision in real-time with the bunch crossing-frequency. The \HLT operates
asynchronously on a processor farm.

\Cref{fig:lhcb_experiment:trigger:overview}\addref{LHCb trigger scheme from speakers bureau} shows an overview of the \LHCb
trigger schematics. The \LZero is described in
\cref{sec:lhcb_experiment:trigger:lzero} while more information on the \HLT can
be found in \cref{sec:lhcb_experiment:trigger:hlt}. Details on the \LHCb trigger
system and its performance during \RunOne can be found in
\Refs~\cite{Aaij:2012me,Albrecht:2013fba}.
%
\begin{figure}[t]
  \centering
  %% trim={<left> <lower> <right> <upper>}
  \includegraphics[width=0.45\textwidth, trim={14.5cm 1.4cm 14.5cm 1.4cm}, clip=true]{private/content/the-lhcb-experiment/figs/lhcb_trigger_overview.pdf}
  \caption{
    The \acs{LHCb} trigger scheme.
  }
  \label{fig:lhcb_experiment:trigger:overview}
\end{figure}

%%------------------------------------------------------------------------------
\subsection{The \acl*{LZero} hardware trigger}
\label{sec:lhcb_experiment:trigger:lzero}

The \LZero trigger incorporates information from the \VELO pile-up system, the
calorimeters, and the muon system to provide a decision in under
$\SI{4}{\micro\second}$ after the bunch crossing. This reduces the read-out rate
from the \LHC bunch crossing rate of up to $\SI{40}{\mega\hertz}$ to
$\SI{1}{\mega\hertz}$ at which the full detector can be read out. The \LZero
triggers on the highest \ET calorimeter clusters and the two highest \pT muons
in the muon system. Additionally global event properties as the number of
primary \protonproton interactions estimated by the \VELO pile-up system and the
number of \SPD hits are used to reject events with large combinatorics.

\newpage
%%------------------------------------------------------------------------------
\subsection{The \acl*{HLT}}
\label{sec:lhcb_experiment:trigger:hlt}

To further reduce the data rate the \HLT software trigger handles all events
that pass the \LZero. The \HLT itself is further split into two stages, the
\acs{HLT}1 and the \acs{HLT}2. The first stage performs a partial event
reconstruction using track information from the \VELO, the muon system, and the
main tracker to accept events with high \pT tracks. The second \HLT stage then
performs a full event reconstruction on the events passed by the \acs{HLT}1.
Both \HLT stages further reduce the event rate to $\SIrange[range-units =
single, range-phrase = -]{3}{5}{\kilo\hertz}$ before the data is written to
permanent storage.

The \HLT excels in is flexibility and performance, especially regarding the
selection of (di-)muon events. As the \LHC delivers stable physics beams in
about $\SI{30}{\percent}$ of the time, local storage on the computing nodes is
used to \enquote{defer} around $\SI{20}{\percent}$ of the \LZero-passed events
to process them during periods without stable beams \cite{Frank:2014ixa}.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Online system}
\DAQ, \TFC, and \ECS
\begin{itemize}
  \item \DAQ: transport of bunch-crossing data from the detector fond-end electornics to permanent storage
  \item Front-end detector electronics -> TELL1 board : receiver cards -> \acp{FPGA} (processing, zero-suppresion, data compression) -> SyncLink (another \FPGA) collect and send raw IP-packet by GbEthernet mezzanine cards -> DAQ
  \item TELL1 has a credit-card size PC connected that interfaces to the \ECS
  \item Clock and synchronisation signals (\eg triggers) are transmitted trough the on-board \TTC interface
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Software stack}
\begin{itemize}
  \item \Gaudi: LHCb software framework (used by ATLAS as well)
  \item \Brunel: reconstruction
  \item \Moore: trigger
  \item \DaVinci: end-user analysis software
  \item Simulation: \Gauss, \Boole, \Pythia, \EvtGen, \Photos, \Herwigpp, \Sherpa, \GeantFour
\end{itemize}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Computing grid}
...

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{\RunTwo and the \acs*{LHCb} upgrade}
Short description of Run II and Upgrade physics goals, the changes wrt now and what will be possible; a more detailed analysis of the Run II prospects for sin2beta will be given in the conclusions.
